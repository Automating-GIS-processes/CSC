

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-88382509-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Vector Data I/O from various formats / sources &mdash; Intro to Python GIS CSC documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exercise 2" href="../../lessons/L2/ex-2.html" />
    <link rel="prev" title="Map projections" href="projections.html" />
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Intro to Python GIS
          

          
            
            <img src="../../_static/logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2018
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/who-are-you.html">Who are you?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/Installing_Anacondas_GIS.html">Installing Python + GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/License-terms.html">License and terms of usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/geometric-objects.html">Geometric objects - Spatial data model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/ex-1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/overview.html">Lesson 2 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="geopandas-basics.html">Introduction to Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="projections.html">Map projections</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vector Data I/O from various formats / sources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-Shapefile">Read / write Shapefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-GeoJSON">Read / write GeoJSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-KML">Read / write KML</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-Geopackage">Read / write Geopackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-GeoDatabase">Read / write GeoDatabase</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-MapInfo-Tab">Read / write MapInfo Tab</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-PostGIS-database-using-psycopg2">Read PostGIS database using psycopg2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-PostGIS-database-using-SqlAlchemy-+-GeoAlchemy">Read / write PostGIS database using SqlAlchemy + GeoAlchemy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-/-write-Spatialite-database">Read / write Spatialite database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-Web-Feature-Service-(WFS)">Read Web Feature Service (WFS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/ex-2.html">Exercise 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/Geocoding_in_Geopandas.html">Geocoding in Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/retrieve_osm_data.html">Retrieving OpenStreetMap data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L3/reclassify.html">Data reclassification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/ex-3.html">Exercise 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/Point-in-polygon.html">Point in Polygon &amp; Intersect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/spatial-join.html">Spatial join</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/nearest-neighbour.html">Nearest Neighbour Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/ex-4.html">Exercise 4</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/download-data.html">Automatize data download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/reading-raster.html">Reading raster files with Rasterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/plotting-raster.html">Visualizing raster layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/clipping-raster.html">Masking / clipping raster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/raster-map-algebra.html">Raster map algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/raster-mosaic.html">Creating a raster mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/zonal-statistics.html">Zonal statistics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Intro to Python GIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Vector Data I/O from various formats / sources</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Automating-GIS-processes/CSC/blob/master/source/notebooks/L2/data_io.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  






<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/Automating-GIS-processes/CSC/blob/master/source/notebooks/L2/data_io.ipynb">source/notebooks/L2/data_io.ipynb</a>.
<span class="raw-html"><br/><a href="https://mybinder.org/v2/gh/Automating-GIS-processes/CSC/master?urlpath=lab/tree/source/notebooks/L2/data_io.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-full%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://mybinder.org/v2/gh/Automating-GIS-processes/notebooks-csc/master?urlpath=lab/tree/notebooks/L2/data_io.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-student%20binder-red.svg" style="vertical-align:text-bottom"></a></span></div>
<div class="section" id="Vector-Data-I/O-from-various-formats-/-sources">
<h1>Vector Data I/O from various formats / sources<a class="headerlink" href="#Vector-Data-I/O-from-various-formats-/-sources" title="Permalink to this headline">¶</a></h1>
<p>In GIS, there are various different data formats and sources (such as
databases or WFS) that can be used to read the data. This tutorial will
show some typical examples how to read (and write) from different
alternatives.</p>
<ul class="simple">
<li>To see all possible file formats supported by GDAL, execute
following:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># See all available drivers supported by GDAL</span>
<span class="kn">import</span> <span class="nn">fiona</span>
<span class="kn">from</span> <span class="nn">fiona._drivers</span> <span class="kn">import</span> <span class="n">GDALEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">GDALEnv</span><span class="p">()</span>

<span class="c1"># This will print all available Drivers supported by GDAL</span>
<span class="c1"># All these can be used for reading data from them</span>
<span class="c1"># and most often also writing data into</span>

<span class="n">env</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">drivers</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[44]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dict_keys([&#39;PCIDSK&#39;, &#39;netCDF&#39;, &#39;JP2OpenJPEG&#39;, &#39;PDF&#39;, &#39;DB2ODBC&#39;, &#39;ESRI Shapefile&#39;, &#39;MapInfo File&#39;, &#39;UK .NTF&#39;, &#39;OGR_SDTS&#39;, &#39;S57&#39;, &#39;DGN&#39;, &#39;OGR_VRT&#39;, &#39;REC&#39;, &#39;Memory&#39;, &#39;BNA&#39;, &#39;CSV&#39;, &#39;NAS&#39;, &#39;GML&#39;, &#39;GPX&#39;, &#39;KML&#39;, &#39;GeoJSON&#39;, &#39;OGR_GMT&#39;, &#39;GPKG&#39;, &#39;SQLite&#39;, &#39;ODBC&#39;, &#39;WAsP&#39;, &#39;PGeo&#39;, &#39;MSSQLSpatial&#39;, &#39;PostgreSQL&#39;, &#39;OpenFileGDB&#39;, &#39;XPlane&#39;, &#39;DXF&#39;, &#39;CAD&#39;, &#39;Geoconcept&#39;, &#39;GeoRSS&#39;, &#39;GPSTrackMaker&#39;, &#39;VFK&#39;, &#39;PGDUMP&#39;, &#39;OSM&#39;, &#39;GPSBabel&#39;, &#39;SUA&#39;, &#39;OpenAir&#39;, &#39;OGR_PDS&#39;, &#39;WFS&#39;, &#39;HTF&#39;, &#39;AeronavFAA&#39;, &#39;Geomedia&#39;, &#39;EDIGEO&#39;, &#39;GFT&#39;, &#39;SVG&#39;, &#39;CouchDB&#39;, &#39;Cloudant&#39;, &#39;Idrisi&#39;, &#39;ARCGEN&#39;, &#39;SEGUKOOA&#39;, &#39;SEGY&#39;, &#39;XLS&#39;, &#39;ODS&#39;, &#39;XLSX&#39;, &#39;ElasticSearch&#39;, &#39;Walk&#39;, &#39;Carto&#39;, &#39;AmigoCloud&#39;, &#39;SXF&#39;, &#39;Selafin&#39;, &#39;JML&#39;, &#39;PLSCENES&#39;, &#39;CSW&#39;, &#39;VDV&#39;, &#39;GMLAS&#39;, &#39;TIGER&#39;, &#39;AVCBin&#39;, &#39;AVCE00&#39;, &#39;HTTP&#39;])
</pre></div>
</div>
</div>
<div class="section" id="Read-/-write-Shapefile">
<h2>Read / write Shapefile<a class="headerlink" href="#Read-/-write-Shapefile" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>

<span class="c1"># Read file from Shapefile</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.shp&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

<span class="c1"># Write to Shapefile (just make a copy)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland_copy.shp&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;L2_data/Finland.sqlite&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;SQLite&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">DriverError</span>                               Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-37-d3aa9d8ec46f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>data<span class="ansi-yellow-intense-fg ansi-bold">.</span>to_file<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;L2_data/Finland.sqlite&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> driver<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;SQLite&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">C:\ProgramData\Anaconda3\lib\site-packages\geopandas\geodataframe.py</span> in <span class="ansi-cyan-fg">to_file</span><span class="ansi-blue-intense-fg ansi-bold">(self, filename, driver, schema, **kwargs)</span>
<span class="ansi-green-fg">    411</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">    412</span>         <span class="ansi-green-intense-fg ansi-bold">from</span> geopandas<span class="ansi-yellow-intense-fg ansi-bold">.</span>io<span class="ansi-yellow-intense-fg ansi-bold">.</span>file <span class="ansi-green-intense-fg ansi-bold">import</span> to_file
<span class="ansi-green-intense-fg ansi-bold">--&gt; 413</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>to_file<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> filename<span class="ansi-yellow-intense-fg ansi-bold">,</span> driver<span class="ansi-yellow-intense-fg ansi-bold">,</span> schema<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    414</span>
<span class="ansi-green-fg">    415</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> to_crs<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> crs<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> epsg<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> inplace<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">C:\ProgramData\Anaconda3\lib\site-packages\geopandas\io\file.py</span> in <span class="ansi-cyan-fg">to_file</span><span class="ansi-blue-intense-fg ansi-bold">(df, filename, driver, schema, **kwargs)</span>
<span class="ansi-green-fg">    108</span>     <span class="ansi-green-intense-fg ansi-bold">with</span> fiona<span class="ansi-yellow-intense-fg ansi-bold">.</span>drivers<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    109</span>         with fiona.open(filename, &#39;w&#39;, driver=driver, crs=df.crs,
<span class="ansi-green-intense-fg ansi-bold">--&gt; 110</span><span class="ansi-yellow-intense-fg ansi-bold">                         schema=schema, **kwargs) as colxn:
</span><span class="ansi-green-fg">    111</span>             colxn<span class="ansi-yellow-intense-fg ansi-bold">.</span>writerecords<span class="ansi-yellow-intense-fg ansi-bold">(</span>df<span class="ansi-yellow-intense-fg ansi-bold">.</span>iterfeatures<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    112</span>

<span class="ansi-green-intense-fg ansi-bold">C:\ProgramData\Anaconda3\lib\site-packages\fiona\__init__.py</span> in <span class="ansi-cyan-fg">open</span><span class="ansi-blue-intense-fg ansi-bold">(path, mode, driver, schema, crs, encoding, layer, vfs, enabled_drivers, crs_wkt)</span>
<span class="ansi-green-fg">    173</span>         c = Collection(path, mode, crs=crs, driver=driver, schema=this_schema,
<span class="ansi-green-fg">    174</span>                        encoding<span class="ansi-yellow-intense-fg ansi-bold">=</span>encoding<span class="ansi-yellow-intense-fg ansi-bold">,</span> layer<span class="ansi-yellow-intense-fg ansi-bold">=</span>layer<span class="ansi-yellow-intense-fg ansi-bold">,</span> vsi<span class="ansi-yellow-intense-fg ansi-bold">=</span>vsi<span class="ansi-yellow-intense-fg ansi-bold">,</span> archive<span class="ansi-yellow-intense-fg ansi-bold">=</span>archive<span class="ansi-yellow-intense-fg ansi-bold">,</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 175</span><span class="ansi-yellow-intense-fg ansi-bold">                        enabled_drivers=enabled_drivers, crs_wkt=crs_wkt)
</span><span class="ansi-green-fg">    176</span>     <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    177</span>         raise ValueError(

<span class="ansi-green-intense-fg ansi-bold">C:\ProgramData\Anaconda3\lib\site-packages\fiona\collection.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, path, mode, driver, schema, crs, encoding, layer, vsi, archive, enabled_drivers, crs_wkt, **kwargs)</span>
<span class="ansi-green-fg">    116</span>             <span class="ansi-green-intense-fg ansi-bold">elif</span> driver <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> supported_drivers<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    117</span>                 raise DriverError(
<span class="ansi-green-intense-fg ansi-bold">--&gt; 118</span><span class="ansi-yellow-intense-fg ansi-bold">                     &#34;unsupported driver: %r&#34; % driver)
</span><span class="ansi-green-fg">    119</span>             <span class="ansi-green-intense-fg ansi-bold">elif</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>mode <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">in</span> supported_drivers<span class="ansi-yellow-intense-fg ansi-bold">[</span>driver<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    120</span>                 raise DriverError(

<span class="ansi-red-intense-fg ansi-bold">DriverError</span>: unsupported driver: &#39;SQLite&#39;
</pre></div></div>
</div>
</div>
<div class="section" id="Read-/-write-GeoJSON">
<h2>Read / write GeoJSON<a class="headerlink" href="#Read-/-write-GeoJSON" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>

<span class="c1"># Read file from GeoJSON</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.geojson&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>

<span class="c1"># Write to GeoJSON (just make a copy)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland_copy.geojson&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-KML">
<h2>Read / write KML<a class="headerlink" href="#Read-/-write-KML" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>

<span class="c1"># Enable KML driver</span>
<span class="n">gpd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">fiona</span><span class="o">.</span><span class="n">drvsupport</span><span class="o">.</span><span class="n">supported_drivers</span><span class="p">[</span><span class="s1">&#39;KML&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;rw&#39;</span>

<span class="c1"># Read file from KML</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.kml&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

<span class="c1"># Write to KML (just make a copy)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland_copy.kml&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;KML&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-Geopackage">
<h2>Read / write Geopackage<a class="headerlink" href="#Read-/-write-Geopackage" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>

<span class="c1"># Read file from Geopackage</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.gpkg&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

<span class="c1"># Write to Geopackage (just make a copy)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland_copy.gpkg&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GPKG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-GeoDatabase">
<h2>Read / write GeoDatabase<a class="headerlink" href="#Read-/-write-GeoDatabase" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>

<span class="c1"># Read file from File Geodatabase</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.gdb&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;FileGDB&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>

<span class="c1"># Write to same FileGDB (just add a new layer)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.gdb&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;FileGDB&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s2">&quot;country_copy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-MapInfo-Tab">
<h2>Read / write MapInfo Tab<a class="headerlink" href="#Read-/-write-MapInfo-Tab" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read file from MapInfo Tab</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland.tab&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;MapInfo File&quot;</span><span class="p">)</span>

<span class="c1"># Write to same FileGDB (just add a new layer)</span>
<span class="n">outfp</span> <span class="o">=</span> <span class="s2">&quot;L2_data/Finland_copy.tab&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">outfp</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;MapInfo File&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-PostGIS-database-using-psycopg2">
<h2>Read PostGIS database using psycopg2<a class="headerlink" href="#Read-PostGIS-database-using-psycopg2" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">psycopg2</span>

<span class="c1"># Create connection to database with psycopg2 module (update params according your db)</span>
<span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s1">&#39;my_postgis_database&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;my_usrname&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;my_pwd&#39;</span><span class="p">,</span>
                                <span class="n">host</span><span class="o">=</span><span class="s1">&#39;123.22.432.16&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">)</span>

<span class="c1"># Specify sql query</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM MY_TABLE;&quot;</span>

<span class="c1"># Read data from PostGIS</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="o">=</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-PostGIS-database-using-SqlAlchemy-+-GeoAlchemy">
<h2>Read / write PostGIS database using SqlAlchemy + GeoAlchemy<a class="headerlink" href="#Read-/-write-PostGIS-database-using-SqlAlchemy-+-GeoAlchemy" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">MetaData</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">sessionmaker</span>
<span class="kn">from</span> <span class="nn">geoalchemy2</span> <span class="kn">import</span> <span class="n">WKTElement</span><span class="p">,</span> <span class="n">Geometry</span>

<span class="c1"># Update with your db parameters</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s1">&#39;123.234.345.16&#39;</span>
<span class="n">DB</span> <span class="o">=</span> <span class="s1">&#39;my_database&#39;</span>
<span class="n">USER</span> <span class="o">=</span> <span class="s1">&#39;my_user&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">5432</span>
<span class="n">PWD</span> <span class="o">=</span> <span class="s1">&#39;my_password&#39;</span>

<span class="c1"># Database info</span>
<span class="n">db_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">drivername</span><span class="o">=</span><span class="s1">&#39;postgresql+psycopg2&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">HOST</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">DB</span><span class="p">,</span>
                   <span class="n">username</span><span class="o">=</span><span class="n">USER</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">PORT</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">PWD</span><span class="p">)</span>

<span class="c1"># Create engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">db_url</span><span class="p">)</span>

<span class="c1"># Init Metadata</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>

<span class="c1"># Load table definitions from db</span>
<span class="n">meta</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

<span class="c1"># Create session</span>
<span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>

<span class="c1"># ========================</span>
<span class="c1"># Read data from PostGIS</span>
<span class="c1"># ========================</span>

<span class="c1"># Specify sql query</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM finland;&quot;</span>

<span class="c1"># Pull the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_postgis</span><span class="p">(</span><span class="n">sql</span><span class="o">=</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>

<span class="c1"># Close session</span>
<span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># =========================================</span>
<span class="c1"># Write data to PostGIS (make a copy table)</span>
<span class="c1"># =========================================</span>

<span class="c1"># Coordinate Reference System (srid)</span>
<span class="n">crs</span> <span class="o">=</span> <span class="mi">4326</span>

<span class="c1"># Target table</span>
<span class="n">target_table</span> <span class="o">=</span> <span class="s1">&#39;finland_copy&#39;</span>

<span class="c1"># Convert Shapely geometries to WKTElements into column &#39;geom&#39; (default in PostGIS)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;geom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">WKTElement</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">wkt</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="n">crs</span><span class="p">))</span>

<span class="c1"># Drop Shapely geometries</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Write to PostGIS (overwrite if table exists, be careful with this! )</span>
<span class="c1"># Possible behavior: &#39;replace&#39;, &#39;append&#39;, &#39;fail&#39;</span>

<span class="n">data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">target_table</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-/-write-Spatialite-database">
<h2>Read / write Spatialite database<a class="headerlink" href="#Read-/-write-Spatialite-database" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Parse Geometry type of the input Data</span>
<span class="n">gtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gtype</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Mixed Geometries! Cannot insert into SQLite table.&quot;</span>
<span class="n">gtype</span> <span class="o">=</span> <span class="n">gtype</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">geom_type</span> <span class="o">=</span> <span class="n">gtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="n">geom_type</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[43]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;POLYGON&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">shapely.wkb</span> <span class="kn">as</span> <span class="nn">swkb</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">sqlite3</span> <span class="kn">import</span> <span class="n">dbapi2</span> <span class="k">as</span> <span class="n">sqlite</span>

<span class="c1"># DB path</span>
<span class="n">dbfp</span> <span class="o">=</span> <span class="s1">&#39;L2_data/Finland.sqlite&#39;</span>

<span class="c1"># Name for the table</span>
<span class="n">tbl_name</span> <span class="o">=</span> <span class="s1">&#39;finland&#39;</span>

<span class="c1"># SRID (crs of your data)</span>
<span class="n">srid</span> <span class="o">=</span> <span class="mi">4326</span>

<span class="c1"># Parse Geometry type of the input Data</span>
<span class="n">gtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gtype</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Mixed Geometries! Cannot insert into SQLite table.&quot;</span>
<span class="n">geom_type</span> <span class="o">=</span> <span class="n">gtype</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="c1"># Initialize database engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///{db}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">dbfp</span><span class="p">),</span> <span class="n">module</span><span class="o">=</span><span class="n">sqlite</span><span class="p">)</span>

<span class="c1"># Initialize table without geometries</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dbdata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbfp</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">tbl_name</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Enable spatialite extension</span>
<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbfp</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">enable_load_extension</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;mod_spatialite&quot;</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT InitSpatialMetaData(1);&quot;</span><span class="p">)</span>
    <span class="c1"># Add geometry column with specified CRS with defined geometry typehaving two dimensions</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="s2">&quot;SELECT AddGeometryColumn({table}, &#39;wkb_geometry&#39;,</span><span class="se">\</span>
<span class="s2">        {srid}, {geom_type}, 2);&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">tbl_name</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="n">srid</span><span class="p">,</span> <span class="n">geom_type</span><span class="o">=</span><span class="n">geom_type</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">OperationalError</span>                          Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-48-dd1a55f72739&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">     32</span> <span class="ansi-green-intense-fg ansi-bold">with</span> sqlite3<span class="ansi-yellow-intense-fg ansi-bold">.</span>connect<span class="ansi-yellow-intense-fg ansi-bold">(</span>dbfp<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">as</span> conn<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     33</span>     conn<span class="ansi-yellow-intense-fg ansi-bold">.</span>enable_load_extension<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-green-intense-fg ansi-bold">True</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 34</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>conn<span class="ansi-yellow-intense-fg ansi-bold">.</span>load_extension<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;mod_spatialite&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     35</span>     conn<span class="ansi-yellow-intense-fg ansi-bold">.</span>execute<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;SELECT InitSpatialMetaData(1);&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     36</span>     <span class="ansi-red-intense-fg ansi-bold"># Add geometry column with specified CRS with defined geometry typehaving two dimensions</span>

<span class="ansi-red-intense-fg ansi-bold">OperationalError</span>: The specified module could not be found.

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">shapely.wkb</span> <span class="kn">as</span> <span class="nn">swkb</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">event</span>

<span class="c1"># DB path</span>
<span class="n">dbfp</span> <span class="o">=</span> <span class="s1">&#39;L2_data/Finland.sqlite&#39;</span>

<span class="c1"># Name for the table</span>
<span class="n">tbl_name</span> <span class="o">=</span> <span class="s1">&#39;finland&#39;</span>

<span class="c1"># SRID (crs of your data)</span>
<span class="n">srid</span> <span class="o">=</span> <span class="mi">4326</span>

<span class="c1"># Parse Geometry type of the input Data</span>
<span class="n">gtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">geom_type</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gtype</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Mixed Geometries! Cannot insert into SQLite table.&quot;</span>
<span class="n">geom_type</span> <span class="o">=</span> <span class="n">gtype</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="c1"># Initialize database engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///{db}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">dbfp</span><span class="p">),</span> <span class="n">module</span><span class="o">=</span><span class="n">sqlite</span><span class="p">)</span>

<span class="c1"># Initialize table without geometries</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbfp</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">tbl_name</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Enable spatialite extension</span>
<span class="k">with</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbfp</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">enable_load_extension</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;mod_spatialite&quot;</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT InitSpatialMetaData(1);&quot;</span><span class="p">)</span>
    <span class="c1"># Add geometry column with specified CRS with defined geometry typehaving two dimensions</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="s2">&quot;SELECT AddGeometryColumn({table}, &#39;wkb_geometry&#39;,</span><span class="se">\</span>
<span class="s2">        {srid}, {geom_type}, 2);&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">tbl_name</span><span class="p">,</span> <span class="n">srid</span><span class="o">=</span><span class="n">srid</span><span class="p">,</span> <span class="n">geom_type</span><span class="o">=</span><span class="n">geom_type</span><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Convert Shapely geometries into well-known-binary format</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">geom</span><span class="p">:</span> <span class="n">swkb</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">geom</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TZID</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Europe/Helsinki</td>
      <td>POLYGON ((20.66716575622559 63.24361038208009,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Europe/Helsinki</td>
      <td>POLYGON ((26.5991382598877 60.36155700683594, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Europe/Helsinki</td>
      <td>POLYGON ((26.53350067138672 60.36066818237305,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Europe/Helsinki</td>
      <td>POLYGON ((21.44886016845703 61.61077880859375,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Europe/Helsinki</td>
      <td>POLYGON ((21.58166694641113 61.62277603149414,...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Read-Web-Feature-Service-(WFS)">
<h2>Read Web Feature Service (WFS)<a class="headerlink" href="#Read-Web-Feature-Service-(WFS)" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="kn">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">geojson</span>

<span class="c1"># Specify the url for the backend</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://geo.stat.fi/geoserver/vaestoruutu/wfs&#39;</span>

<span class="c1"># Specify parameters (read data in json format)</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s1">&#39;WFS&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;2.0.0&#39;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="s1">&#39;GetFeature&#39;</span><span class="p">,</span>
         <span class="n">typeName</span><span class="o">=</span><span class="s1">&#39;vaestoruutu:vaki2017_5km&#39;</span><span class="p">,</span> <span class="n">outputFormat</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>

<span class="c1"># Fetch data from WFS using requests</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Create GeoDataFrame from geojson</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">geojson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../lessons/L2/ex-2.html" class="btn btn-neutral float-right" title="Exercise 2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="projections.html" class="btn btn-neutral" title="Map projections" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Henrikki Tenkanen
      Last updated on Nov 12, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="data_io.html">master</a></dd>
        </dl>
    </div>
</div>


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'CSC',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>