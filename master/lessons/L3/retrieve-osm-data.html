

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-88382509-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Retrieving OpenStreetMap data &mdash; Intro to Python GIS CSC documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Intro to Python GIS
          

          
            
            <img src="../../_static/logo_small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2018
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/who-are-you.html">Who are you?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/Installing_Anacondas_GIS.html">Installing Python + GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/License-terms.html">License and terms of usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L1/overview.html">Lesson overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L1/geometric-objects.html">Geometric objects - Spatial data model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/ex-1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L2/overview.html">Lesson 2 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L2/geopandas-basics.html">Introduction to Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L2/projections.html">Map projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L2/data_io.html">Vector Data I/O from various formats / sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/ex-2.html">Exercise 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L3/Geocoding_in_Geopandas.html">Geocoding in Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L3/reclassify.html">Data reclassification</a></li>
<li class="toctree-l1"><a class="reference internal" href="ex-3.html">Exercise 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L4/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L4/spatial-join.html">Spatial join</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L4/nearest-neighbour.html">Nearest Neighbour Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L4/ex-4.html">Exercise 4</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L5/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/download-data.html">Automatize data download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L5/reading-raster.html">Reading raster files with Rasterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L5/plotting-raster.html">Visualizing raster layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L5/clipping-raster.html">Masking / clipping raster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L5/raster-map-algebra.html">Raster map algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L5/raster-mosaic.html">Creating a raster mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L5/zonal-statistics.html">Zonal statistics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Intro to Python GIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Retrieving OpenStreetMap data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Automating-GIS-processes/CSC/blob/master/source/lessons/L3/retrieve-osm-data.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  






<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="retrieving-openstreetmap-data">
<h1>Retrieving OpenStreetMap data<a class="headerlink" href="#retrieving-openstreetmap-data" title="Permalink to this headline">¶</a></h1>
<div class="figure">
<img alt="../../_images/OSM_logo.png" src="../../_images/OSM_logo.png" />
</div>
<div class="section" id="what-is-openstreetmap">
<h2>What is OpenStreetMap?<a class="headerlink" href="#what-is-openstreetmap" title="Permalink to this headline">¶</a></h2>
<p>OpenStreetMap (OSM) is a global collaborative (crowd-sourced) dataset and project that aims at creating a free editable map of the world
containing a lot of information about our environment.
It contains data for example about streets, buildings, different services, and landuse to mention a few.</p>
<p>OSM has a large userbase with more than 4 million users that contribute actively on OSM by updating the OSM database
with 3 million changesets per day. In total OSM contains more than 4 billion nodes that form the basis of the digitally
mapped world that OSM provides (<a class="reference external" href="http://wiki.openstreetmap.org/wiki/Stats">stats from November 2017</a>.</p>
<p>OpenStreetMap is used not only for integrating the <strong>OSM maps</strong> as background maps to visualizations or online maps,
but also for many other purposes such as <strong>routing</strong>, <strong>geocoding</strong>, <strong>education</strong>, and <strong>research</strong>. OSM is also widely used for
humanitarian response e.g. in crisis areas (e.g. after natural disasters) and for fostering economic development
(see more from <a class="reference external" href="https://www.hotosm.org/">Humanitarian OpenStreetMap Team (HOTOSM) website</a>.</p>
</div>
<div class="section" id="osmnx">
<h2>Osmnx<a class="headerlink" href="#osmnx" title="Permalink to this headline">¶</a></h2>
<p>This week we will explore a new and exciting Python module called <a class="reference external" href="https://github.com/gboeing/osmnx">osmnx</a>
that can be used to retrieve, construct, analyze, and visualize street networks from OpenStreetMap.
In short it offers really handy functions to download data from OpenStreet map, analyze the properties of the OSM street networks,
and conduct network routing based on walking, cycling or driving.</p>
<p>There is also a scientific article available describing the package:</p>
<blockquote>
<div><ul class="simple">
<li>Boeing, G. 2017. <a class="reference external" href="https://www.researchgate.net/publication/309738462_OSMnx_New_Methods_for_Acquiring_Constructing_Analyzing_and_Visualizing_Complex_Street_Networks">“OSMnx: New Methods for Acquiring, Constructing, Analyzing, and Visualizing Complex Street Networks.”</a> Computers, Environment and Urban Systems 65, 126-139. doi:10.1016/j.compenvurbsys.2017.05.004</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="download-and-visualize-openstreetmap-data-with-osmnx">
<h2>Download and visualize OpenStreetMap data with osmnx<a class="headerlink" href="#download-and-visualize-openstreetmap-data-with-osmnx" title="Permalink to this headline">¶</a></h2>
<p>As said, one the most useful features that osmnx provides is an easy-to-use way of retrieving <a class="reference external" href="http://www.openstreetmap.org/">OpenStreetMap</a> data
(using <a class="reference external" href="http://wiki.openstreetmap.org/wiki/Overpass_API">OverPass API</a> ).</p>
<p>Let’s see how we can download and visualize street network data from a district of Kamppi in Helsinki, Finland.
Osmnx makes it really easy to do that as it allows you to specify an address to retrieve the OpenStreetMap data around that area.
In fact, osmnx uses the same Nominatim Geocoding API to achieve this which we tested during the Lesson 2.</p>
<ul class="simple">
<li>Let’s retrieve OpenStreetMap (OSM) data by specifying <code class="docutils literal notranslate"><span class="pre">&quot;Kamppi,</span> <span class="pre">Helsinki,</span> <span class="pre">Finland&quot;</span></code> as the address where the data should be downloaded.</li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">osmnx</span> <span class="kn">as</span> <span class="nn">ox</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="gp">In [3]: </span><span class="n">place_name</span> <span class="o">=</span> <span class="s2">&quot;Kamppi, Helsinki, Finland&quot;</span>

<span class="gp">In [4]: </span><span class="n">graph</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">graph_from_place</span><span class="p">(</span><span class="n">place_name</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">WantReadError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/contrib/pyopenssl.py</span> in <span class="ni">wrap_socket</span><span class="nt">(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname)</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">444</span>                 <span class="n">cnx</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>             <span class="k">except</span> <span class="n">OpenSSL</span><span class="o">.</span><span class="n">SSL</span><span class="o">.</span><span class="n">WantReadError</span><span class="p">:</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/OpenSSL/SSL.py</span> in <span class="ni">do_handshake</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1906</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_lib</span><span class="o">.</span><span class="n">SSL_do_handshake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1907</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_raise_ssl_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1908</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/OpenSSL/SSL.py</span> in <span class="ni">_raise_ssl_error</span><span class="nt">(self, ssl, result)</span>
<span class="g g-Whitespace">   </span><span class="mi">1613</span>         <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="n">_lib</span><span class="o">.</span><span class="n">SSL_ERROR_WANT_READ</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1614</span>             <span class="k">raise</span> <span class="n">WantReadError</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1615</span>         <span class="k">elif</span> <span class="n">error</span> <span class="o">==</span> <span class="n">_lib</span><span class="o">.</span><span class="n">SSL_ERROR_WANT_WRITE</span><span class="p">:</span>

<span class="ne">WantReadError</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">timeout</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">343</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_validate_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>         <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_validate_conn</span><span class="nt">(self, conn)</span>
<span class="g g-Whitespace">    </span><span class="mi">848</span>         <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&#39;sock&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>  <span class="c1"># AppEngine might not have  `.sock`</span>
<span class="ne">--&gt; </span><span class="mi">849</span>             <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">850</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py</span> in <span class="ni">connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>             <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">356</span>             <span class="n">ssl_context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/ssl_.py</span> in <span class="ni">ssl_wrap_socket</span><span class="nt">(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir)</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>         <span class="k">if</span> <span class="n">HAS_SNI</span> <span class="ow">and</span> <span class="n">server_hostname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">359</span>             <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/contrib/pyopenssl.py</span> in <span class="ni">wrap_socket</span><span class="nt">(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname)</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>                 <span class="k">if</span> <span class="ow">not</span> <span class="n">util</span><span class="o">.</span><span class="n">wait_for_read</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">sock</span><span class="o">.</span><span class="n">gettimeout</span><span class="p">()):</span>
<span class="ne">--&gt; </span><span class="mi">447</span>                     <span class="k">raise</span> <span class="n">timeout</span><span class="p">(</span><span class="s1">&#39;select timed out&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span>                 <span class="k">continue</span>

<span class="ne">timeout</span>: select timed out

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ReadTimeoutError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>                     <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">445</span>                     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>                 <span class="p">)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>             <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">638</span>                                         <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span>             <span class="n">retries</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/retry.py</span> in <span class="ni">increment</span><span class="nt">(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>             <span class="k">if</span> <span class="n">read</span> <span class="ow">is</span> <span class="bp">False</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_method_retryable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">367</span>                 <span class="k">raise</span> <span class="n">six</span><span class="o">.</span><span class="n">reraise</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="n">error</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span>             <span class="k">elif</span> <span class="n">read</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/packages/six.py</span> in <span class="ni">reraise</span><span class="nt">(tp, value, tb)</span>
<span class="g g-Whitespace">    </span><span class="mi">685</span>             <span class="k">raise</span> <span class="n">value</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">686</span>         <span class="k">raise</span> <span class="n">value</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">599</span>                                                   <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">600</span>                                                   <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span>             <span class="c1"># Py2 raises this as a BaseSSLError, Py3 raises it as socket timeout.</span>
<span class="ne">--&gt; </span><span class="mi">346</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_raise_timeout</span><span class="p">(</span><span class="n">err</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout_value</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span>             <span class="k">raise</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_raise_timeout</span><span class="nt">(self, err, url, timeout_value)</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">SocketTimeout</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">306</span>             <span class="k">raise</span> <span class="n">ReadTimeoutError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="s2">&quot;Read timed out. (read timeout=</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">timeout_value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span> 

<span class="ne">ReadTimeoutError</span>: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Read timed out. (read timeout=30)

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ReadTimeout</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-4-2fe842a0d6eb&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">graph_from_place</span><span class="p">(</span><span class="n">place_name</span><span class="p">)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">graph_from_place</span><span class="nt">(query, network_type, simplify, retain_all, truncate_by_edge, name, which_result, buffer_dist, timeout, memory, max_query_area_size, clean_periphery, infrastructure, custom_filter)</span>
<span class="g g-Whitespace">   </span><span class="mi">1847</span>         <span class="c1"># if it is a string (place name) or dict (structured place query), then</span>
<span class="g g-Whitespace">   </span><span class="mi">1848</span>         <span class="c1"># it is a single place</span>
<span class="ne">-&gt; </span><span class="mi">1849</span>         <span class="n">gdf_place</span> <span class="o">=</span> <span class="n">gdf_from_place</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="n">which_result</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="o">=</span><span class="n">buffer_dist</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1850</span>         <span class="n">name</span> <span class="o">=</span> <span class="n">query</span>
<span class="g g-Whitespace">   </span><span class="mi">1851</span>     <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">gdf_from_place</span><span class="nt">(query, gdf_name, which_result, buffer_dist)</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span> 
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># get the data from OSM</span>
<span class="ne">--&gt; </span><span class="mi">438</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">osm_polygon_download</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">which_result</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">which_result</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">osm_polygon_download</span><span class="nt">(query, limit, polygon_geojson)</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span> 
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="c1"># request the URL, return the JSON</span>
<span class="ne">--&gt; </span><span class="mi">406</span>     <span class="n">response_json</span> <span class="o">=</span> <span class="n">nominatim_request</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>     <span class="k">return</span> <span class="n">response_json</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">nominatim_request</span><span class="nt">(params, pause_duration, timeout, error_pause_duration)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Requesting {} with timeout={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prepared_url</span><span class="p">,</span> <span class="n">timeout</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">262</span>         <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">get_http_headers</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> 
<span class="g g-Whitespace">    </span><span class="mi">264</span>         <span class="c1"># get the response size and the domain, log result</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> 
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allow_redirects&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> 
<span class="g g-Whitespace">     </span><span class="mi">74</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span>     <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">58</span>         <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> 
<span class="g g-Whitespace">     </span><span class="mi">60</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>         <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>         <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">512</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span> 
<span class="g g-Whitespace">    </span><span class="mi">514</span>         <span class="k">return</span> <span class="n">resp</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py</span> in <span class="ni">send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span> 
<span class="g g-Whitespace">    </span><span class="mi">621</span>         <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">622</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span> 
<span class="g g-Whitespace">    </span><span class="mi">624</span>         <span class="c1"># Total elapsed time of the request (approximately)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span>                 <span class="k">raise</span> <span class="n">SSLError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">525</span>             <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">ReadTimeoutError</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">526</span>                 <span class="k">raise</span> <span class="n">ReadTimeout</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">527</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">528</span>                 <span class="k">raise</span>

<span class="ne">ReadTimeout</span>: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Read timed out. (read timeout=30)

<span class="gp">In [5]: </span><span class="nb">type</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-5-e279804376b1&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 type(graph)</span>

<span class="go">NameError: name &#39;graph&#39; is not defined</span>
</pre></div>
</div>
<p>Okey, as we can see the data that we retrieved is a special data object called <code class="docutils literal notranslate"><span class="pre">networkx.classes.multidigraph.MultiDiGraph</span></code>. A DiGraph is a data type that stores nodes and edges with optional data, or attributes.
What we can see here is that this data type belongs to a Python module called <a class="reference external" href="https://networkx.github.io/documentation/stable/">networkx</a>
that can be used to create, manipulate, and study the structure, dynamics, and functions of complex networks.
Networkx module contains algorithms that can be used to calculate <a class="reference external" href="https://networkx.github.io/documentation/networkx-1.10/reference/algorithms.shortest_paths.html">shortest paths</a>
along networks using e.g. <a class="reference external" href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">Dijkstra’s</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/A*_search_algorithm">A* algorithm</a>.</p>
<ul class="simple">
<li>Let’s see how our street network looks like. It is easy to visualize the graph with osmnx with <code class="docutils literal notranslate"><span class="pre">plot_graph()</span></code> function. The function utilizes Matplotlib for visualizing the data,</li>
</ul>
<p>hence as a result it returns a matplotlib figure and axis objects.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-6-559a0acfe53a&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;graph&#39; is not defined

<span class="gp">In [7]: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/graph.png"><img alt="../../_images/graph.png" src="../../_images/graph.png" style="width: 5in;" /></a>
<p>Great! Now we can see that our graph contains the nodes (blue circles) and the edges (gray lines) that connects those nodes to each other.</p>
<p>It is also possible to retrieve other types of OSM data features with osmnx.</p>
<ul class="simple">
<li>Let’s download the buildings with <code class="docutils literal notranslate"><span class="pre">buildings_from_place()</span></code> function and plot them on top of our street network in Kamppi. Let’s also plot the Polygon that represents the area of Kamppi,</li>
</ul>
<p>Helsinki that can be retrieved with <code class="docutils literal notranslate"><span class="pre">gdf_from_place</span></code> function.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">area</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">gdf_from_place</span><span class="p">(</span><span class="n">place_name</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">timeout</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py</span> in <span class="ni">_new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>             <span class="n">conn</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">171</span>                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dns_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/connection.py</span> in <span class="ni">create_connection</span><span class="nt">(address, timeout, source_address, socket_options)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">79</span>         <span class="k">raise</span> <span class="n">err</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/connection.py</span> in <span class="ni">create_connection</span><span class="nt">(address, timeout, source_address, socket_options)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>                 <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">source_address</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">69</span>             <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>             <span class="k">return</span> <span class="n">sock</span>

<span class="ne">timeout</span>: timed out

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ConnectTimeoutError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">599</span>                                                   <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">600</span>                                                   <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">343</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_validate_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>         <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_validate_conn</span><span class="nt">(self, conn)</span>
<span class="g g-Whitespace">    </span><span class="mi">848</span>         <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&#39;sock&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>  <span class="c1"># AppEngine might not have  `.sock`</span>
<span class="ne">--&gt; </span><span class="mi">849</span>             <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">850</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py</span> in <span class="ni">connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="c1"># Add certificate verification</span>
<span class="ne">--&gt; </span><span class="mi">314</span>         <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_conn</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py</span> in <span class="ni">_new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>                 <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Connection to </span><span class="si">%s</span><span class="s2"> timed out. (connect timeout=</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span>
<span class="ne">--&gt; </span><span class="mi">176</span>                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span> 

<span class="ne">ConnectTimeoutError</span>: (&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b7dd128&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;)

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">MaxRetryError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>                     <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">445</span>                     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>                 <span class="p">)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span>             <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">638</span>                                         <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span>             <span class="n">retries</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/retry.py</span> in <span class="ni">increment</span><span class="nt">(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span>         <span class="k">if</span> <span class="n">new_retry</span><span class="o">.</span><span class="n">is_exhausted</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">398</span>             <span class="k">raise</span> <span class="n">MaxRetryError</span><span class="p">(</span><span class="n">_pool</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span> <span class="ow">or</span> <span class="n">ResponseError</span><span class="p">(</span><span class="n">cause</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> 

<span class="ne">MaxRetryError</span>: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Max retries exceeded with url: /search?format=json&amp;limit=1&amp;dedupe=0&amp;polygon_geojson=1&amp;q=Kamppi%2C+Helsinki%2C+Finland (Caused by ConnectTimeoutError(&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b7dd128&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;))

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ConnectTimeout</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-8-62d509989fb5&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">area</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">gdf_from_place</span><span class="p">(</span><span class="n">place_name</span><span class="p">)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">gdf_from_place</span><span class="nt">(query, gdf_name, which_result, buffer_dist)</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span> 
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># get the data from OSM</span>
<span class="ne">--&gt; </span><span class="mi">438</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">osm_polygon_download</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">which_result</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">which_result</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">osm_polygon_download</span><span class="nt">(query, limit, polygon_geojson)</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span> 
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="c1"># request the URL, return the JSON</span>
<span class="ne">--&gt; </span><span class="mi">406</span>     <span class="n">response_json</span> <span class="o">=</span> <span class="n">nominatim_request</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span>     <span class="k">return</span> <span class="n">response_json</span>
<span class="g g-Whitespace">    </span><span class="mi">408</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py</span> in <span class="ni">nominatim_request</span><span class="nt">(params, pause_duration, timeout, error_pause_duration)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="n">log</span><span class="p">(</span><span class="s1">&#39;Requesting {} with timeout={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prepared_url</span><span class="p">,</span> <span class="n">timeout</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">262</span>         <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">get_http_headers</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> 
<span class="g g-Whitespace">    </span><span class="mi">264</span>         <span class="c1"># get the response size and the domain, log result</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> 
<span class="g g-Whitespace">     </span><span class="mi">71</span>     <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allow_redirects&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> 
<span class="g g-Whitespace">     </span><span class="mi">74</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span>     <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">58</span>         <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> 
<span class="g g-Whitespace">     </span><span class="mi">60</span> 

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>         <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>         <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">512</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span> 
<span class="g g-Whitespace">    </span><span class="mi">514</span>         <span class="k">return</span> <span class="n">resp</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py</span> in <span class="ni">send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span> 
<span class="g g-Whitespace">    </span><span class="mi">621</span>         <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">622</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span> 
<span class="g g-Whitespace">    </span><span class="mi">624</span>         <span class="c1"># Total elapsed time of the request (approximately)</span>

<span class="nn">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">499</span>                 <span class="c1"># TODO: Remove this in 3.0.0: see #2811</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span>                 <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">NewConnectionError</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">501</span>                     <span class="k">raise</span> <span class="n">ConnectTimeout</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span> 
<span class="g g-Whitespace">    </span><span class="mi">503</span>             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">ResponseError</span><span class="p">):</span>

<span class="ne">ConnectTimeout</span>: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Max retries exceeded with url: /search?format=json&amp;limit=1&amp;dedupe=0&amp;polygon_geojson=1&amp;q=Kamppi%2C+Helsinki%2C+Finland (Caused by ConnectTimeoutError(&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b7dd128&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;))

<span class="gp">In [9]: </span><span class="n">buildings</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">buildings_from_place</span><span class="p">(</span><span class="n">place_name</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ---------------------------------------------------------------------------</span>
<span class="go">timeout                                   Traceback (most recent call last)</span>
<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py in _new_conn(self)</span>
<span class="go">    170             conn = connection.create_connection(</span>
<span class="go">--&gt; 171                 (self._dns_host, self.port), self.timeout, **extra_kw)</span>
<span class="go">    172 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/connection.py in create_connection(address, timeout, source_address, socket_options)</span>
<span class="go">     78     if err is not None:</span>
<span class="go">---&gt; 79         raise err</span>
<span class="go">     80 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/connection.py in create_connection(address, timeout, source_address, socket_options)</span>
<span class="go">     68                 sock.bind(source_address)</span>
<span class="go">---&gt; 69             sock.connect(sa)</span>
<span class="go">     70             return sock</span>

<span class="go">timeout: timed out</span>

<span class="go">During handling of the above exception, another exception occurred:</span>

<span class="go">ConnectTimeoutError                       Traceback (most recent call last)</span>
<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="go">    599                                                   body=body, headers=headers,</span>
<span class="go">--&gt; 600                                                   chunked=chunked)</span>
<span class="go">    601 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py in _make_request(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="go">    342         try:</span>
<span class="go">--&gt; 343             self._validate_conn(conn)</span>
<span class="go">    344         except (SocketTimeout, BaseSSLError) as e:</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py in _validate_conn(self, conn)</span>
<span class="go">    848         if not getattr(conn, &#39;sock&#39;, None):  # AppEngine might not have  `.sock`</span>
<span class="go">--&gt; 849             conn.connect()</span>
<span class="go">    850 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py in connect(self)</span>
<span class="go">    313         # Add certificate verification</span>
<span class="go">--&gt; 314         conn = self._new_conn()</span>
<span class="go">    315 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connection.py in _new_conn(self)</span>
<span class="go">    175                 self, &quot;Connection to %s timed out. (connect timeout=%s)&quot; %</span>
<span class="go">--&gt; 176                 (self.host, self.timeout))</span>
<span class="go">    177 </span>

<span class="go">ConnectTimeoutError: (&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b81eb38&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;)</span>

<span class="go">During handling of the above exception, another exception occurred:</span>

<span class="go">MaxRetryError                             Traceback (most recent call last)</span>
<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="go">    444                     retries=self.max_retries,</span>
<span class="go">--&gt; 445                     timeout=timeout</span>
<span class="go">    446                 )</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="go">    637             retries = retries.increment(method, url, error=e, _pool=self,</span>
<span class="go">--&gt; 638                                         _stacktrace=sys.exc_info()[2])</span>
<span class="go">    639             retries.sleep()</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/urllib3/util/retry.py in increment(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="go">    397         if new_retry.is_exhausted():</span>
<span class="go">--&gt; 398             raise MaxRetryError(_pool, url, error or ResponseError(cause))</span>
<span class="go">    399 </span>

<span class="go">MaxRetryError: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Max retries exceeded with url: /search?format=json&amp;limit=1&amp;dedupe=0&amp;polygon_geojson=1&amp;q=Kamppi%2C+Helsinki%2C+Finland (Caused by ConnectTimeoutError(&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b81eb38&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;))</span>

<span class="go">During handling of the above exception, another exception occurred:</span>

<span class="go">ConnectTimeout                            Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-9-5cba73cb9448&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 buildings = ox.buildings_from_place(place_name)</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/buildings.py in buildings_from_place(place, retain_invalid)</span>
<span class="go">    287     &quot;&quot;&quot;</span>
<span class="go">    288 </span>
<span class="go">--&gt; 289     city = gdf_from_place(place)</span>
<span class="go">    290     polygon = city[&#39;geometry&#39;].iloc[0]</span>
<span class="go">    291     return create_buildings_gdf(polygon, retain_invalid=retain_invalid)</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py in gdf_from_place(query, gdf_name, which_result, buffer_dist)</span>
<span class="go">    436 </span>
<span class="go">    437     # get the data from OSM</span>
<span class="go">--&gt; 438     data = osm_polygon_download(query, limit=which_result)</span>
<span class="go">    439     if len(data) &gt;= which_result:</span>
<span class="go">    440 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py in osm_polygon_download(query, limit, polygon_geojson)</span>
<span class="go">    404 </span>
<span class="go">    405     # request the URL, return the JSON</span>
<span class="go">--&gt; 406     response_json = nominatim_request(params=params, timeout=30)</span>
<span class="go">    407     return response_json</span>
<span class="go">    408 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/osmnx/core.py in nominatim_request(params, pause_duration, timeout, error_pause_duration)</span>
<span class="go">    260         start_time = time.time()</span>
<span class="go">    261         log(&#39;Requesting {} with timeout={}&#39;.format(prepared_url, timeout))</span>
<span class="go">--&gt; 262         response = requests.get(url, params=params, timeout=timeout, headers=get_http_headers())</span>
<span class="go">    263 </span>
<span class="go">    264         # get the response size and the domain, log result</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py in get(url, params, **kwargs)</span>
<span class="go">     70 </span>
<span class="go">     71     kwargs.setdefault(&#39;allow_redirects&#39;, True)</span>
<span class="go">---&gt; 72     return request(&#39;get&#39;, url, params=params, **kwargs)</span>
<span class="go">     73 </span>
<span class="go">     74 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/api.py in request(method, url, **kwargs)</span>
<span class="go">     56     # cases, and look like a memory leak in others.</span>
<span class="go">     57     with sessions.Session() as session:</span>
<span class="go">---&gt; 58         return session.request(method=method, url=url, **kwargs)</span>
<span class="go">     59 </span>
<span class="go">     60 </span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="go">    510         }</span>
<span class="go">    511         send_kwargs.update(settings)</span>
<span class="go">--&gt; 512         resp = self.send(prep, **send_kwargs)</span>
<span class="go">    513 </span>
<span class="go">    514         return resp</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/sessions.py in send(self, request, **kwargs)</span>
<span class="go">    620 </span>
<span class="go">    621         # Send the request</span>
<span class="go">--&gt; 622         r = adapter.send(request, **kwargs)</span>
<span class="go">    623 </span>
<span class="go">    624         # Total elapsed time of the request (approximately)</span>

<span class="go">~/miniconda/envs/autogis-environment/lib/python3.5/site-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="go">    499                 # TODO: Remove this in 3.0.0: see #2811</span>
<span class="go">    500                 if not isinstance(e.reason, NewConnectionError):</span>
<span class="go">--&gt; 501                     raise ConnectTimeout(e, request=request)</span>
<span class="go">    502 </span>
<span class="go">    503             if isinstance(e.reason, ResponseError):</span>

<span class="go">ConnectTimeout: HTTPSConnectionPool(host=&#39;nominatim.openstreetmap.org&#39;, port=443): Max retries exceeded with url: /search?format=json&amp;limit=1&amp;dedupe=0&amp;polygon_geojson=1&amp;q=Kamppi%2C+Helsinki%2C+Finland (Caused by ConnectTimeoutError(&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7efd9b81eb38&gt;, &#39;Connection to nominatim.openstreetmap.org timed out. (connect timeout=30)&#39;))</span>

<span class="gp">In [10]: </span><span class="nb">type</span><span class="p">(</span><span class="n">area</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-10-368c4fa0b8ee&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 type(area)</span>

<span class="go">NameError: name &#39;area&#39; is not defined</span>

<span class="gp">In [11]: </span><span class="nb">type</span><span class="p">(</span><span class="n">buildings</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-11-ee532beaa4de&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 type(buildings)</span>

<span class="go">NameError: name &#39;buildings&#39; is not defined</span>
</pre></div>
</div>
<p>As a result we got the data as GeoDataFrames. Hence, we can plot them using the familiar <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function of Geopandas.
As you might remember the street network data was not in GeoDataFrame. Luckily, osmnx provides a convenient function <code class="docutils literal notranslate"><span class="pre">graph_to_gdfs()</span></code>
that can convert the graph into two separate GeoDataFrames where the first one contains the information about the nodes and the second one
about the edges.</p>
<ul class="simple">
<li>Let’s extract the nodes and edges from the graph as GeoDataFrames.</li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">graph_to_gdfs</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-12-3de8ab08da95&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">graph_to_gdfs</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;graph&#39; is not defined

<span class="gp">In [13]: </span><span class="n">nodes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">                                                                                                                                                                                                                                                                                             ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-13-47083f45a780&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 nodes.head()</span>

<span class="go">NameError: name &#39;nodes&#39; is not defined</span>

<span class="gp">In [14]: </span><span class="n">edges</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-14-74fa6e7602a3&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 edges.head()</span>

<span class="go">NameError: name &#39;edges&#39; is not defined</span>

<span class="gp">In [15]: </span><span class="nb">type</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-15-520b6b5f2c05&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 type(edges)</span>

<span class="go">NameError: name &#39;edges&#39; is not defined</span>
</pre></div>
</div>
<p>Nice! Now, as we can see, we have our graph as GeoDataFrames and we can plot them using the same functions and tools as we have used before.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are also other ways of retrieving the data from OpenStreetMap with osmnx such as passing a Polygon to extract the data from that area,
or passing a Point coordinates and retrieving data around that location with specific radius.
Take a look of this <a class="reference external" href="https://github.com/gboeing/osmnx-examples/blob/master/notebooks/01-overview-osmnx.ipynb">tutorial to find out how to use those features of osmnx</a>.</p>
</div>
<ul class="simple">
<li>Let’s create a map out of the streets, buildings, and the area Polygon but let’s exclude the nodes (to keep the figure clearer).</li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="gp">In [17]: </span><span class="n">area</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-17-ef660def8d05&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">area</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;area&#39; is not defined

<span class="gp">In [18]: </span><span class="n">edges</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;#BC8F8F&#39;</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                         ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-18-c0ea898698f4&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 edges.plot(ax=ax, linewidth=1, edgecolor=&#39;#BC8F8F&#39;)</span>

<span class="go">NameError: name &#39;edges&#39; is not defined</span>

<span class="gp">In [19]: </span><span class="n">buildings</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;khaki&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="go">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-19-65971f202ae8&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 buildings.plot(ax=ax, facecolor=&#39;khaki&#39;, alpha=0.7)</span>

<span class="go">NameError: name &#39;buildings&#39; is not defined</span>

<span class="gp">In [20]: </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/city_plot.png"><img alt="../../_images/city_plot.png" src="../../_images/city_plot.png" style="width: 5in;" /></a>
<p>Cool! Now we have a map where we have plotted the buildings, streets and the boundaries of the selected region of ‘Kamppi’ in Helsinki.
And all of this required only a few lines of code. Pretty neat! Next, we will start exploring how we can use OSM
data to do network analysis.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last"><strong>Task</strong>
Column <code class="docutils literal notranslate"><span class="pre">highway</span></code> in our <code class="docutils literal notranslate"><span class="pre">edges</span></code> GeoDataFrame contains information about the type of the street (such as <code class="docutils literal notranslate"><span class="pre">primacy,</span> <span class="pre">cycleway</span> <span class="pre">or</span> <span class="pre">footway</span></code>).
Select the streets that are walkable or that can be used with cycle and visualize only them with the buildings and the area polygon. Use different colors and line widths for the cycleways and footways.</p>
</div>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">There are a few nice and convenient high-level functions in <a class="reference external" href="https://github.com/gboeing/osmnx">osmnx</a> that can be used to produce nice maps directly just by using a single function that might be useful.
If you are interested take a look of <a class="reference external" href="https://github.com/gboeing/osmnx-examples/blob/master/notebooks/10-building-footprints.ipynb">this tutorial</a>.
In the lesson we won’t cover these, because we wanted to keep as much control to ourselves as possible, hence using lower-level functions.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Henrikki Tenkanen
      Last updated on Jan 14, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="retrieve-osm-data.html">master</a></dd>
        </dl>
    </div>
</div>


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'CSC',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>